<div class="home-navigation">
	<span class="back">Back</span>
	<span class="title">View History</span>
</div>
<div class="home">
	<div class="survey-block">
		<div class="home-menu-list">
			<ul id="survey-list"></ul>
		</div>
	</div>
</div>

<!-- survey history template -->
<script id="surveyHistoryListTemplate" type="x-jquery-tmpl">
	<li>${description} <span class='survey-status'> ${notSynchronized}ppl | ${readySynchronized}sync</span></li>
</script>

<script>
$(function(){
	surveyDao.getAll(function(surveys) {
		$.each(surveys,function(index,survey){
			var surveyId = survey.getSurveyId();
			participantSurveyDao.countParticipantBySurveyKey(surveyId, function(status){
				var li = $("#surveyHistoryListTemplate").tmpl({clickEvent: onclick,description: survey.getDescription1(), notSynchronized: status.notSync,readySynchronized: status.sync});
				li.bind("click",function(){
					loadHistoryDetail(surveyId,survey.getDescription1());
				});
				$("#survey-list").append(li);
			});
		});
	});
	
	$(".back").click(function(){
		$("#content").load("static/view/home.html");
	});
});
function loadHistoryDetail(surveyId,description1) {
	participantSurveyDao.getBySurvey(surveyId, function(participants) {
		$("body").data("participantSurveys", participants);
		$("#selectedSurvey").data("selectedSurvey", {"surveyId": surveyId, "description": description1});
		$("#content").load("static/view/viewHistoryDetail.html");
	});
}
</script>